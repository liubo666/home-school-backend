# 开发环境配置

spring:
  datasource:
    url: jdbc:mysql://localhost:3306/home_school?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true
    username: root
    password: root
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000

  # JPA配置（使用JPA而不是MyBatis Plus） - 配置详细SQL日志
  jpa:
    hibernate:
      ddl-auto: validate  # 使用Flyway管理数据库结构
    show-sql: true
    properties:
      hibernate:
        format_sql: true  # 格式化SQL输出
        generate_statistics: false  # 关闭统计功能，避免频繁的统计日志
        dialect: org.hibernate.dialect.MySQL8Dialect
        use_sql_comments: true  # 显示SQL注释
        # 配置SQL日志输出格式，类似MyBatis Plus
        jdbc:
          batch_versioned_data: true
          batch_queries: true
        # 启用慢SQL检测（大于1秒的SQL会被记录）
        session:
          events:
            log:
              jdbc:
                binder: true
    open-in-view: false

  data:
    redis:
      host: localhost
      port: 6379
      password:
      database: 0

  # 开发工具
  devtools:
    restart:
      enabled: true
      additional-paths: src/main/java
    livereload:
      enabled: true

# 日志配置 - 添加类似MyBatis Plus的SQL日志效果
logging:
  level:
    root: INFO
    com.school.cooperation: DEBUG
    org.springframework.security: DEBUG
    org.springframework.web: DEBUG
    org.springframework.cache: DEBUG
    # Hibernate SQL日志配置 - 类似MyBatis Plus效果
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE  # 显示SQL参数值
    org.hibernate.type.descriptor.sql.BasicExtractor: TRACE  # 显示查询结果值
    org.hibernate.engine.QueryParameters: DEBUG  # 显示查询参数
    org.hibernate.engine.jdbc.spi.SqlExceptionHelper: WARN  # SQL异常
    org.hibernate.tool.hbm2ddl: WARN  # DDL日志
    org.hibernate.hql.internal.ast.QueryTranslatorImpl: DEBUG  # HQL解析
    # 禁用Hibernate统计日志，减少噪音
    org.hibernate.stat: WARN
    org.hibernate.event.internal.AbstractFlushingEventListener: WARN
    org.hibernate.engine.internal.StatisticalLoggingSessionEventListener: WARN
    # HikariCP连接池日志
    com.zaxxer.hikari: INFO

# MinIO开发环境配置
minio:
  endpoint: http://localhost:9000
  access-key: minioadmin
  secret-key: minioadmin
  bucket-name: home-school-dev

# Knife4j开发环境配置
knife4j:
  enable: true
  production: false
  setting:
    enable-debug: true
    enable-swagger-models: true

# JWT配置
jwt:
  secret: mySecretKey123456789012345678901234567890  # 至少32字符，与application.yml保持一致
  expiration: 7200000  # 2小时（毫秒）
  refresh-expiration: 604800000  # 7天（毫秒）

# Actuator开发环境配置
management:
  endpoints:
    web:
      exposure:
        include: "*"
  endpoint:
    health:
      show-details: always